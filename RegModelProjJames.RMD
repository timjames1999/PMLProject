---
title: "Regression Model Project, MPG vs. Transmission"
author: "Jerin Timothy James"
date: "2023-09-09"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Executive Summary
In the role as a Motor Trend employee (a magazine about the automobile industry) the following, the below analysis of the mtcars data set is presented to answer questions about Miles Per Gallon (mpg) differences. The two questions of particular interest are:

1. “Is an automatic or manual transmission better for MPG”

2. "Quantify the MPG difference between automatic and manual transmissions"  

Answers:

1 & 2. Taken as a solo variable, a manual transmission is approx 7 mpg more efficient.

Note: When looked at in a larger context, a better mpg model can be put together with variables such as weight, engine size, and gearing included.


### Exploratory Data Analysis

First we need to load the required data set and examine its structure with the below code:

```{r} 
#Load needed library and data
library(ggplot2)

#Load data
data(mtcars)
#?mtcars

#according to ?mtcars, The data was extracted from the 1974 Motor Trend US magazine, 
#and comprises fuel consumption and 10 aspects of automobile design and 
#performance for 32 automobiles (1973–74 models). And that it is A data frame 
#with 32 observations on 11 (numeric) variables. 
#*Note that [, 9]	am	Transmission (0 = automatic, 1 = manual)

#Initial data exploration
str(mtcars)
head(mtcars)
```

Next we classify some of the variables as factors to ease functions such as plotting with informative labels:

```{r} 
#Change to factors for ease 
mtcars$vs <- factor(mtcars$vs)
mtcars$am <- factor(mtcars$am, labels=c("Automatic","Manual"))
mtcars$gear <- factor(mtcars$gear)
mtcars$carb <- factor(mtcars$carb)
mtcars$cyl <- factor(mtcars$cyl)
```

Now we can take a simple approach to see if the type of transmission affects mpg with the following code:

```{r}
#Visual and mean validation of difference in mpg
boxplot(mpg ~ am, mtcars, col = (c("lightgrey","darkgrey")), ylab = "Miles Per Gallon", 
        xlab = "Transmission Type")
aggregate(mtcars$mpg,by=list(mtcars$am),FUN=mean)
```

We see that there is a significant difference based on the provided data. The automatic transmissions are averaging 17.1 mpg while the manuals are averaging 24.4 mpg. The box plots further show that the quantiles of data points are not in significant overlap.

### Linear Regression Provides More Detailed Analysis

With a data set more complete than just transmission and mpg data, we can investigate if that is a complete model, or if there may be more/additional influential factors in action.

The below code is a linear regression of transmission vs mpg and shows, via a low Rsquared value, that in the data collected, perhaps only 1/3 of the difference in mpg of the 32 cars is properly assigned to transmission alone.

```{r}
#Linear regression for more in depth mpg validation
lmam<-lm(mpg~am,mtcars)
summary(lmam)
```

The next step taken was to look at an analysis of variation amoung the various variables given in the mtcars data set to see if additional influencers could be easily found in the below code.

```{r}
#Brief look for influential variables
summary(aov(mpg ~ ., mtcars))
```

Looking at this data, and noticing only 5 of the 11 variables are under a 0.25 p value, another model was proposed including all of those factors in the below code. (Note, horsepower is under 0.25 but not a physical trait difference, but a performance product of the other included variables, and was therefor not included).

```{r}
#More inclusive model for mpg variance
lmam2<-lm(mpg ~ am + cyl + disp + wt + drat, mtcars)
summary(lmam2)
```

Looking at the RSquared in this model shows much more (over 80%) of the mpg variation is explained.  This model fits with a commmon sense understanding of mpg influencers too (weight, engine size, gearing)

### Model Validation

Finally we take a quick look at the residual plots below to show that they meet the criteria to consider the model unbiased, namely that the residuals are homoscedastic and normally distributed, with the exception of a few outliers.

```{r}
#Residual analysis for model validation
par(mfrow = c(2, 2))
plot(lmam2)
```


## Conclusion: 
The data supports the claim that manual transmissions are more fuel efficient than automatic transmissions.  The data also supports there are other significant factors that change mpg, such as weight, engine size, and gear ratios. Further data gathering and analysis is recommended for a more precise model as this data set was very small in both size and variety relative to the quantity of vehicles in operation and the number of vehicle compositions available. 